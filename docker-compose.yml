services:
  web:
    image: file-uploader
    build: .
    env_file:
      - .env
    restart: always
    depends_on:
      - mariadb
      - thumbor
    environment:
      DATABASE_URL: mysql://root:file-uploader@mariadb:3306/file-uploader
      THUMBOR_ENDPOINT: http://thumbor
      THUMBOR_SECRET: hackme
  mariadb:
    image: 'mariadb'
    restart: always
    environment:
      MARIADB_DATABASE: file-uploader
      MARIADB_ROOT_PASSWORD: file-uploader
  thumbor:
    build:
      dockerfile: thumbor.Dockerfile
    restart: always
    environment:
      SECURITY_KEY: hackme
      ALLOW_UNSAFE_URL": False
      STORAGE: thumbor.storages.no_storage
      ENGINE: thumbor_video_engine.engines.video
